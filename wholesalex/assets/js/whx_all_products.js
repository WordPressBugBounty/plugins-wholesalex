(()=>{"use strict";var e={5338(e,t,a){var n=a(5795);t.createRoot=n.createRoot,n.hydrateRoot},5795(e){e.exports=window.ReactDOM}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,a),l.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const n=window.React;var r=a.n(n),l=a(5338);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function i(e,t,a){return(t=function(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=c(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const o=window.wp.i18n,m=window.wp.components,s=window.wp.primitives,p=window.ReactJSXRuntime;var u=(0,p.jsx)(s.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(s.Path,{d:"m19 7-3-3-8.5 8.5-1 4 4-1L19 7Zm-7 11.5H5V20h7v-1.5Z"})}),d=(0,p.jsx)(s.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,p.jsx)(s.Path,{d:"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z"})}),x=(0,p.jsx)(s.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,p.jsx)(s.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})}),_=(0,p.jsx)(s.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,p.jsx)(s.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M12.218 5.377a.25.25 0 0 0-.436 0l-7.29 12.96a.25.25 0 0 0 .218.373h14.58a.25.25 0 0 0 .218-.372l-7.29-12.96Zm-1.743-.735c.669-1.19 2.381-1.19 3.05 0l7.29 12.96a1.75 1.75 0 0 1-1.525 2.608H4.71a1.75 1.75 0 0 1-1.525-2.608l7.29-12.96ZM12.75 17.46h-1.5v-1.5h1.5v1.5Zm-1.5-3h1.5v-5h-1.5v5Z"})});function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach(function(t){i(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}const E=e=>{let{data:t,frequency:a}=e;const n=window.location.href;return t&&0!==t.length?React.createElement(m.__experimentalScrollable,{scrollDirection:"x",style:{width:"100%"}},React.createElement(m.Card,{size:"small",isBorderless:!0},React.createElement(m.CardBody,null,React.createElement(m.__experimentalGrid,{gap:6,templateColumns:"minmax(260px, 2fr) minmax(180px, 1.8fr) minmax(80px, 1fr) 40px"},React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Rule Title","wholesalex")),React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Rule Type","wholesalex")),React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Applied For","wholesalex")),React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Edit","wholesalex"))))),React.createElement(m.__experimentalScrollable,{scrollDirection:"y",style:{height:"40vh",maxHeight:340,minWidth:"fit-content"}},React.createElement(m.__experimentalVStack,{spacing:3,style:{padding:2}},t.map((e,t)=>React.createElement(m.Card,{size:"small",key:t,variant:"secondary"},React.createElement(m.CardBody,null,React.createElement(m.__experimentalGrid,{gap:6,align:"center",templateColumns:"minmax(260px, 2fr) minmax(180px, 1.8fr) minmax(80px, 1fr) 40px"},React.createElement(m.__experimentalHStack,{align:"stretch"},React.createElement(m.__experimentalText,{truncate:!0,style:{whiteSpace:"nowrap"}},e[0]),React.createElement(m.CardDivider,{orientation:"vertical",style:{width:"auto"}})),React.createElement(m.__experimentalHStack,{align:"stretch"},React.createElement(m.__experimentalText,{truncate:!0,style:{whiteSpace:"nowrap"}},e[1]),React.createElement(m.CardDivider,{orientation:"vertical",style:{width:"auto"}})),React.createElement(m.__experimentalHStack,{align:"stretch"},React.createElement(m.__experimentalText,null,"All Roles"!==e[2]&&"All Users"!==e[2]?"user"===e[2]?"".concat(a[e[3]]," ").concat((0,o.__)("Users","wholesalex")):"".concat(a[e[3]]," ").concat((0,o.__)("Roles","wholesalex")):e[2]),React.createElement(m.CardDivider,{orientation:"vertical",style:{width:"auto"}})),React.createElement(m.Button,{href:n.replace("?post_type=product","?page=wholesalex#/dynamic-rules/edit/".concat(e[3])),target:"_blank",icon:u,variant:"link",size:"small"})))))))):React.createElement(v,null)},w=e=>{let{data:t}=e;return t&&0!==t.length?React.createElement(m.__experimentalScrollable,{scrollDirection:"x",style:{width:"100%"}},React.createElement(m.Card,{size:"small",isBorderless:!0},React.createElement(m.CardBody,null,React.createElement(m.__experimentalGrid,{gap:6,templateColumns:"minmax(300px, 2.5fr) minmax(180px, 1.8fr) 40px"},React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Roles","wholesalex")),React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Discount (Rule) Type","wholesalex")),React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Edit","wholesalex"))))),React.createElement(m.__experimentalScrollable,{scrollDirection:"y",style:{height:"70vh",maxHeight:340,minWidth:"fit-content"}},React.createElement(m.__experimentalVStack,{spacing:3,style:{padding:2}},t.map((e,t)=>React.createElement(m.Card,{size:"small",key:t,variant:"secondary"},React.createElement(m.CardBody,null,React.createElement(m.__experimentalGrid,{gap:6,align:"center",templateColumns:"minmax(300px, 2.5fr) minmax(180px, 1.8fr) 40px"},React.createElement(m.__experimentalHStack,{align:"stretch"},React.createElement(m.__experimentalText,{truncate:!0,style:{whiteSpace:"nowrap"}},e[0]),React.createElement(m.CardDivider,{orientation:"vertical",style:{width:"auto"}})),React.createElement(m.__experimentalHStack,{align:"stretch"},React.createElement(m.__experimentalText,{truncate:!0,style:{whiteSpace:"nowrap"}},e[1]),React.createElement(m.CardDivider,{orientation:"vertical",style:{width:"auto"}})),React.createElement(m.Button,{href:"/wp-admin/post.php?post=".concat(e[2],"&action=edit"),target:"_blank",icon:u,variant:"link",size:"small"})))))))):React.createElement(v,null)},g=e=>{let{variations:t,productName:a,selectedProductId:r}=e;const[l,c]=(0,n.useState)(!1);return React.createElement(m.Card,{size:"small",variant:"secondary"},React.createElement(m.CardHeader,null,React.createElement(m.__experimentalGrid,{gap:6,align:"center",templateColumns:"minmax(300px, 2.5fr) minmax(180px, 1.8fr) 40px",style:{width:"100%"}},React.createElement(m.__experimentalText,{truncate:!0,style:{whiteSpace:"nowrap"}},a),React.createElement(m.Button,{isPressed:l,onClick:()=>c(!l),icon:l?d:x,iconPosition:"right",style:{width:"fit-content"},size:"small",variant:"primary"},l?(0,o.__)("Hide Rules","wholesalex"):(0,o.__)("Show Rules","wholesalex")),React.createElement(m.Button,{href:"/wp-admin/post.php?post=".concat(r,"&action=edit"),target:"_blank",icon:u,variant:"link",size:"small"}))),l&&React.createElement(m.CardBody,null,React.createElement(m.__experimentalVStack,{spacing:3},React.createElement(m.__experimentalGrid,{gap:6,templateColumns:"minmax(180px, 1fr) minmax(240px, 2fr)",style:{padding:"0px 12px"}},React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Roles","wholesalex")),React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Discount (Rule) Type","wholesalex"))),t.map((e,t)=>React.createElement(m.Card,{key:t},React.createElement(m.__experimentalGrid,{gap:6,align:"center",templateColumns:"minmax(180px, 1fr) minmax(240px, 2fr)",style:{padding:"8px 12px"}},React.createElement(m.__experimentalHStack,{align:"stretch"},React.createElement(m.__experimentalText,{truncate:!0,style:{whiteSpace:"nowrap"}},e[0]),React.createElement(m.CardDivider,{orientation:"vertical",style:{width:"auto"}})),React.createElement(m.__experimentalHStack,{align:"stretch"},React.createElement(m.__experimentalText,{truncate:!0,style:{whiteSpace:"nowrap"}},e[1]),React.createElement(m.CardDivider,{orientation:"vertical",style:{width:"auto"}}))))))))},y=e=>{let{data:t}=e;return t&&0!==t.length?React.createElement(m.__experimentalScrollable,{scrollDirection:"x",style:{width:"100%"}},React.createElement(m.Card,{size:"small",isBorderless:!0},React.createElement(m.CardBody,null,React.createElement(m.__experimentalGrid,{gap:6,templateColumns:"minmax(300px, 2.5fr) minmax(180px, 1.8fr) 40px"},React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Roles","wholesalex")),React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Discount (Rule) Type","wholesalex")),React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Edit","wholesalex"))))),React.createElement(m.__experimentalScrollable,{scrollDirection:"y",style:{height:"70vh",maxHeight:340,minWidth:"fit-content"}},React.createElement(m.__experimentalVStack,{spacing:3,style:{padding:2}},t.map((e,t)=>React.createElement(m.Card,{size:"small",key:t,variant:"secondary"},React.createElement(m.CardBody,null,React.createElement(m.__experimentalGrid,{gap:6,align:"center",templateColumns:"minmax(300px, 2.5fr) minmax(180px, 1.8fr) 40px"},React.createElement(m.__experimentalHStack,{align:"stretch"},React.createElement(m.__experimentalText,{truncate:!0,style:{whiteSpace:"nowrap"}},e[0]),React.createElement(m.CardDivider,{orientation:"vertical",style:{width:"auto"}})),React.createElement(m.__experimentalHStack,{align:"stretch"},React.createElement(m.__experimentalText,{truncate:!0,style:{whiteSpace:"nowrap"}},e[1]),React.createElement(m.CardDivider,{orientation:"vertical",style:{width:"auto"}})),React.createElement(m.Button,{href:"/wp-admin/term.php?taxonomy=product_cat&tag_ID=".concat(e[2],"&post_type=product"),target:"_blank",icon:u,variant:"link",size:"small"})))))))):React.createElement(v,null)},f=e=>{let{data:t}=e;return t&&0!==t.length?React.createElement(m.__experimentalScrollable,{scrollDirection:"x",style:{width:"100%"}},React.createElement(m.Card,{size:"small",isBorderless:!0},React.createElement(m.CardBody,null,React.createElement(m.__experimentalGrid,{gap:6,templateColumns:"minmax(120px, 0.5fr) minmax(180px, 1.8fr) minmax(260px, 2.5fr) 40px"},React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("User ID","wholesalex")),React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("User Name","wholesalex")),React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Discount (Rule) Type","wholesalex")),React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Edit","wholesalex"))))),React.createElement(m.__experimentalScrollable,{scrollDirection:"y",style:{height:"70vh",maxHeight:340,minWidth:"fit-content"}},React.createElement(m.__experimentalVStack,{spacing:3,style:{padding:2}},t.map((e,t)=>React.createElement(m.Card,{size:"small",key:t,variant:"secondary"},React.createElement(m.CardBody,null,React.createElement(m.__experimentalGrid,{gap:6,align:"center",templateColumns:"minmax(120px, 0.8fr) minmax(180px, 1.8fr) minmax(260px, 2.5fr) 40px"},React.createElement(m.__experimentalHStack,{align:"stretch"},React.createElement(m.__experimentalText,{truncate:!0,style:{whiteSpace:"nowrap"}},e[0]),React.createElement(m.CardDivider,{orientation:"vertical",style:{width:"auto"}})),React.createElement(m.__experimentalHStack,{align:"stretch"},React.createElement(m.__experimentalText,{truncate:!0,style:{whiteSpace:"nowrap"}},e[1]),React.createElement(m.CardDivider,{orientation:"vertical",style:{width:"auto"}})),React.createElement(m.__experimentalHStack,{align:"stretch"},React.createElement(m.__experimentalText,{truncate:!0,style:{whiteSpace:"nowrap"}},e[2]),React.createElement(m.CardDivider,{orientation:"vertical",style:{width:"auto"}})),React.createElement(m.Button,{href:"/wp-admin/user-edit.php?user_id=".concat(e[3]),target:"_blank",icon:u,variant:"link",size:"small"})))))))):React.createElement(v,null)},v=()=>React.createElement(m.__experimentalVStack,{align:"center",spacing:0},React.createElement(m.Icon,{icon:_,size:120}),React.createElement(m.__experimentalText,{size:20,weight:"500"},(0,o.__)("No rules found","wholesalex"))),S=()=>{const[e,t]=(0,n.useState)(!1),[a,r]=(0,n.useState)("dynamicRules"),[l,c]=(0,n.useState)(null),[i,s]=(0,n.useState)([]);(0,n.useEffect)(()=>{const e=document.getElementById("wsx-product-rule-data");if(e&&e.textContent)try{const t=JSON.parse(e.textContent);s(t)}catch(e){return null}},[]);const p=(0,n.useCallback)(e=>{const a=e.getAttribute("data-product-id");if(!a)return;let n=null;for(let e=0;e<i.length;e++)if(i[e][a]){n=h(h({},i[e][a]),{},{productId:a});break}n&&(c(n),t(!0),r("dynamicRules"))},[i]),u=(0,n.useMemo)(()=>{if(null==l||!l.dynamic)return{data:[],count:0};const e={},t=[];l.dynamic.forEach(a=>{const n=a[3];e[n]||(e[n]=0,t.push(a)),e[n]++});const a=new Set(l.dynamic.map(e=>e[3])).size;return{data:t,frequency:e,count:isNaN(a)?l.dynamic.length:a}},[l]),d=(0,n.useMemo)(()=>{if(null==l||!l.Singles)return{data:[],count:0};const e=Object.entries(l.Singles).map(e=>{let[t,a]=e;return[t,a]});return{data:e,count:e.length}},[l]),x=(0,n.useMemo)(()=>{if(null==l||!l.Single)return{data:[],count:0};const e=Array.isArray(l.Single)?l.Single:Object.entries(l.Single).map(e=>{let[t,a]=e;return[t,a]});return{data:e,count:e.length}},[l]),_=(0,n.useMemo)(()=>{if(null==l||!l.Category)return{data:[],count:0};const e=Array.isArray(l.Category)?l.Category:Object.entries(l.Category).map(e=>{let[t,a]=e;return[t,a]});return{data:e,count:e.length}},[l]),R=(0,n.useMemo)(()=>{if(null==l||!l.Profile)return{data:[],count:0};const e=Array.isArray(l.Profile)?l.Profile:Object.entries(l.Profile).map(e=>{let[t,a]=e;return[t,a]});return{data:e,count:e.length}},[l]),S=(0,n.useMemo)(()=>u.count+d.count+x.count+_.count+R.count,[u,d,x,_,R]);return(0,n.useEffect)(()=>{const e=e=>{const t=e.target.closest("#wsx-wholesalex-product-rule-openModalBtn");t&&(e.preventDefault(),p(t))};return document.addEventListener("click",e,!0),()=>{document.removeEventListener("click",e,!0)}},[p]),e&&l?e&&React.createElement(m.Modal,{size:"large",onRequestClose:()=>t(!1),title:React.createElement(m.__experimentalHStack,{spacing:4},React.createElement(m.__experimentalText,{size:"medium",weight:"semi-bold"},l.product_title),React.createElement(m.__experimentalText,null,"(",S," ",(0,o.__)("Rules Applied","wholesalex"),")")),className:"wsx-product-rule-modal"},React.createElement(React.Fragment,null,React.createElement(m.__experimentalToggleGroupControl,{value:a,onChange:r,isBlock:!0},React.createElement(m.__experimentalToggleGroupControlOption,{value:"dynamicRules",label:React.createElement(React.Fragment,null,(0,o.__)("Dynamic Rules","wholesalex")," ",u.count>0&&"(".concat(u.count,")"))}),React.createElement(m.__experimentalToggleGroupControlOption,{value:"individualProduct",label:React.createElement(React.Fragment,null,(0,o.__)("Individual Product","wholesalex")," ",x.count+d.count>0&&"(".concat(x.count+d.count,")"))}),React.createElement(m.__experimentalToggleGroupControlOption,{value:"category",label:React.createElement(React.Fragment,null,(0,o.__)("Category","wholesalex")," ",_.count>0&&"(".concat(_.count,")"))}),React.createElement(m.__experimentalToggleGroupControlOption,{value:"userProfile",label:React.createElement(React.Fragment,null,(0,o.__)("Profile","wholesalex")," ",R.count>0&&"(".concat(R.count,")"))})),"dynamicRules"===a&&(u.count>0?React.createElement(E,{data:u.data,frequency:u.frequency}):React.createElement(v,null)),"individualProduct"===a&&(x.count>0||d.count>0?React.createElement(React.Fragment,null,0===d.count?null:React.createElement(m.__experimentalScrollable,{scrollDirection:"x",style:{width:"100%"}},React.createElement(m.Card,{size:"small",isBorderless:!0},React.createElement(m.CardBody,null,React.createElement(m.__experimentalGrid,{gap:6,templateColumns:"minmax(300px, 2.5fr) minmax(180px, 1.8fr) 40px"},React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Variations","wholesalex")),React.createElement(m.__experimentalText,null),React.createElement(m.__experimentalText,{weight:"500"},(0,o.__)("Edit","wholesalex"))))),React.createElement(m.__experimentalScrollable,{scrollDirection:"y",style:{height:"70vh",maxHeight:340,minWidth:"fit-content"}},React.createElement(m.__experimentalVStack,{spacing:3,style:{padding:2}},d.data.map(e=>{var t;let[a,n]=e;return React.createElement(g,{key:a,variations:n,productName:(null===(t=n[0])||void 0===t?void 0:t[3])||"Variation",selectedProductId:null==l?void 0:l.productId})})))),x.count>0&&React.createElement(w,{data:x.data,selectedProductId:null==l?void 0:l.productId})):React.createElement(v,null)),"category"===a&&(_.count>0?React.createElement(y,{data:_.data}):React.createElement(v,null)),"userProfile"===a&&(R.count>0?React.createElement(f,{data:R.data}):React.createElement(v,null)))):null},b=e=>{let{productId:t,rulesCount:a}=e;return React.createElement(m.Button,{id:"wsx-wholesalex-product-rule-openModalBtn","data-product-id":t,variant:"primary"},a," ",(0,o.__)("Rules Applied","wholesalex"))},C=new Map,T=()=>{document.querySelectorAll(".wsx-product-rule-button-container").forEach(e=>{const t=e.getAttribute("data-product-id"),a=e.getAttribute("data-rules-count");t&&a&&(C.has(e)||C.set(e,(0,l.createRoot)(e)),C.get(e).render(r().createElement(r().StrictMode,null,r().createElement(b,{productId:t,rulesCount:parseInt(a,10)}))))})};document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("wsx-all-products-rule-modal");e&&(0,l.createRoot)(e).render(r().createElement(r().StrictMode,null,r().createElement(S,null))),T();const t=new MutationObserver(()=>{T()}),a=document.querySelector("#the-list");a&&t.observe(a,{childList:!0,subtree:!0})})})();
//# sourceMappingURL=whx_all_products.js.map